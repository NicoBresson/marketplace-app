{"version":3,"file":"static/webpack/static/development/pages/_app.js.d719d1a424d188a22ab0.hot-update.js","sources":["webpack:///./components/RemoveFromCart.js"],"sourcesContent":["import React from 'react';\nimport { Mutation } from 'react-apollo';\nimport styled from 'styled-components';\nimport Proptypes from 'prop-types';\nimport gql from 'graphql-tag';\nimport { CURRENT_USER_QUERY } from './User';\nimport { render } from 'enzyme';\n\nconst REMOVE_FROM_CART_MUTATION = gql`\n  mutation removeFromCart($id:ID!){\n    removeFromCart(id:$id){\n      id\n    }\n  }\n`;\n\nconst BigButton = styled.button`\n font-size:3rem;\n background:none;\n border:0;\n &:hover{\n   color:${props => props.theme.red};\n   cursor:pointer;\n }\n`\n\nclass RemoveFromCart extends React.Component {\n  static propTypes = {\n    id: Proptypes.string.isRequired\n  }\n  //this gets called as soon as we get a response back grom the server after a mutation as been performed\n  update=(cache,payload)=>{\n    // console.log('Running remove from cart update function')\n    // first read the cache\n    const data = cache.readQuery({query:CURRENT_USER_QUERY});\n    // console.log(data)\n    // remove that item from teh cart\n    const cartItemId = payload.data.removeFromCart.id;\n    data.me.cart = data.me.cart.filter(cartItem => cartItem.id !==cartItemId)\n    //write it back to the cache\n    cache.writeQuery({query: CURRENT_USER_QUERY, data})\n\n  }\n\n  render() {\n    return (<Mutation\n    mutation={REMOVE_FROM_CART_MUTATION}\n    variables={{id:this.props.id}}\n    update={this.update}\n    optimisticResponse={{\n      __typename: 'Mutation',\n      removeFromCart:{\n        __typename:'CartItem',\n        id: this.props.id\n      }\n    }}\n    >\n      {(removeFromCart, { loading, error }) => <BigButton\n      title='Delete Item'\n      disabled={loading}\n        onClick={() => { removeFromCart().catch(err => alert(err.message))}}\n      >&times;</BigButton>}\n    </Mutation>)\n  }\n}\n\nexport default RemoveFromCart;\nexport {REMOVE_FROM_CART_MUTATION};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAQA;AAAA;AAAA;AAAA;AAKA;AAAA;AACA;AAIA;;;;;;;;;;;;;;;;;;AAKA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;;;;;;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;;;;AArCA;AACA;AADA;AAEA;AACA;AAFA;AACA;AAsCA;;;;;A","sourceRoot":""}